# Class 7: Machine Learning !
Woocheol Kim (PID: A16998418

Today, we are going to learn how to apply different machine learning
methods, beginning with clustering:

The goal here is to find groups/clusters in your input data.

First I will make up some data with clear groups. For this I will use
the `rnorm()` function:

``` r
rnorm(10)
```

     [1] -0.9388261 -0.5555351 -1.2794626  0.2861139  0.3656353  0.5414328
     [7]  0.2660049 -1.2402142 -0.9366024 -1.9948182

``` r
hist(rnorm(10000, mean = -3) )
```

![](class07_files/figure-commonmark/unnamed-chunk-2-1.png)

``` r
n <- 10000
x <- c(rnorm(n,-3) , rnorm(n,+3))
hist(x)
```

![](class07_files/figure-commonmark/unnamed-chunk-3-1.png)

``` r
n <- 30
x <- c(rnorm(n,-3) , rnorm(n,+3))
y <- rev(x)

z <- cbind(x,y)
head(z)
```

                 x        y
    [1,] -3.694817 3.135021
    [2,] -2.961910 2.516061
    [3,] -4.491370 3.532352
    [4,] -2.133036 2.365103
    [5,] -4.555794 2.755286
    [6,] -1.479199 3.848314

``` r
plot(z)
```

![](class07_files/figure-commonmark/unnamed-chunk-5-1.png)

Use the `kmeans()` function setting k to 2 and nstart=20

Inspect/print the results

> Q. How many points are in each cluster?

> Q. What ‘component’ of your result object details - cluster size? -
> cluster assignment/membership? - cluster center?

> Q. Plot x colored by the kmeans cluster assignment and add cluster
> centers as blue points

``` r
km <- kmeans(z, centers = 2)
km
```

    K-means clustering with 2 clusters of sizes 30, 30

    Cluster means:
              x         y
    1  2.838323 -2.904232
    2 -2.904232  2.838323

    Clustering vector:
     [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1
    [39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

    Within cluster sum of squares by cluster:
    [1] 46.74298 46.74298
     (between_SS / total_SS =  91.4 %)

    Available components:

    [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
    [6] "betweenss"    "size"         "iter"         "ifault"      

Results in kmeans object `km`

``` r
attributes(km)
```

    $names
    [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
    [6] "betweenss"    "size"         "iter"         "ifault"      

    $class
    [1] "kmeans"

cluster size?

``` r
km$cluster
```

     [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1
    [39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

cluster assignment/membership

``` r
km$cluster
```

     [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1
    [39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

cluster center?

``` r
km$centers
```

              x         y
    1  2.838323 -2.904232
    2 -2.904232  2.838323

> Q. Plot x colored by the kmeans cluster assignment and add cluster
> centers as blue points

R will re-cycle the shorter color vector to be the same length as the
longer (number of data points) in z

``` r
plot(z, col=c("red","blue") )
```

![](class07_files/figure-commonmark/unnamed-chunk-11-1.png)

``` r
plot(z, col=c(1,2) )
```

![](class07_files/figure-commonmark/unnamed-chunk-12-1.png)

``` r
plot(z, col=km$cluster)
```

![](class07_files/figure-commonmark/unnamed-chunk-13-1.png)

We can use the `points()` function to add new points to an existing
plot… like the cluster centers.

``` r
plot(z, col=km$cluster)
points(km$centers, col="blue", pch=5, cex=3)
```

![](class07_files/figure-commonmark/unnamed-chunk-14-1.png)

> Q. Can you run kmeans and ask for 4 clusters please and plot the
> results like we have done above?

``` r
km4 <- kmeans(z, centers = 4)
plot(z, col=km4$cluster)
points(km4$centers, col="blue", pch=5, cex=3)
```

![](class07_files/figure-commonmark/unnamed-chunk-15-1.png)

## Hierarchical Clustering

Let’s take our same made-up data `z` and see how hclust works.

First we need a distance matrix of our data to be clustered.

``` r
d <- dist(z)
hc <- hclust(d)
hc
```


    Call:
    hclust(d = d)

    Cluster method   : complete 
    Distance         : euclidean 
    Number of objects: 60 

``` r
d
```

                 1           2           3           4           5           6
    2   0.95930453                                                            
    3   0.89015088  1.83632721                                                
    4   1.74124525  0.84250819  2.63138966                                    
    5   0.94099913  1.61173719  0.77973192  2.45397658                        
    6   2.32760672  1.99332115  3.02869760  1.62093076  3.26498835            
    7   0.73161101  1.07119273  1.38047914  1.55745538  1.66146702  1.65484178
    8   0.53356582  0.57964866  1.40684998  1.24465767  1.42166231  1.86336403
    9   1.95956811  1.28239002  2.81120895  0.68047469  2.81440446  0.96108973
    10  1.03088610  0.41894722  1.81896129  1.12324975  1.42055684  2.41066210
    11  2.37460953  1.54293609  3.25526238  0.71816955  3.15006985  1.39657397
    12  1.55036730  1.05180682  2.37281131  0.81366449  2.44762676  0.94434574
    13  0.86587215  1.11522064  1.25471450  1.93204623  0.63501767  2.98741775
    14  0.20216464  0.92250873  1.00701855  1.64808887  1.14086690  2.13345855
    15  2.64336036  2.17473537  3.39293290  1.64082449  3.56711045  0.43250627
    16  1.76410328  0.82792276  2.60988109  0.68440099  2.23455849  2.29509019
    17  1.26632957  0.95723654  1.85629639  1.61249806  1.25495472  2.95052344
    18  1.46499234  0.97410124  2.10772180  1.50194956  1.52104851  2.94066982
    19  1.23889937  1.52056590  1.72526630  1.81035271  2.13855173  1.37306336
    20  1.71715197  0.88420050  2.60321066  0.19761165  2.48530318  1.42539445
    21  0.65476091  1.42090959  0.61962488  2.25956321  0.29861668  2.98236240
    22  0.86604646  0.62327989  1.71172558  1.03030225  1.76608949  1.53125186
    23  0.54963295  1.03705814  0.99893386  1.87933785  0.57467911  2.77137286
    24  1.67158415  0.80785802  2.56056237  0.12220347  2.41628158  1.52111602
    25  1.09085042  0.47701732  1.86528272  1.14238035  1.44208591  2.46386405
    26  1.68928782  0.98230413  2.41333260  1.28219771  1.87687731  2.82669002
    27  0.90192945  0.87816822  1.46912672  1.66688674  0.91950962  2.82035476
    28  2.99251337  2.90227385  3.50358212  2.64572548  3.91944525  1.03627893
    29  0.89074073  0.47313053  1.65693335  1.25175700  1.25773151  2.45364857
    30  2.30604163  2.09276294  2.94387235  1.82212637  3.24689884  0.28914200
    31  9.13022479  8.18384481 10.01757619  7.39726081  9.69972086  7.80768916
    32  8.85614091  7.90533893  9.69302085  7.25942459  9.20272756  8.15969363
    33  9.61124494  8.67940826 10.50134751  7.87025770 10.23039213  8.13296304
    34  9.12323106  8.17784980  9.94914756  7.55382872  9.43783933  8.49969296
    35  8.16067985  7.21740387  8.98385876  6.60494081  8.47095696  7.59683798
    36  8.64992959  7.69965044  9.48586680  7.05681988  8.99439428  7.96904236
    37  8.13482204  7.17554122  9.00093893  6.46202912  8.58402563  7.19397639
    38  9.55190091  8.60305743 10.38415615  7.96385158  9.88304241  8.86647195
    39  9.05963471  8.10048951  9.92336822  7.39077389  9.49612828  8.11064688
    40  9.97725607  9.02868480 10.80864989  8.38952585 10.30485551  9.28488850
    41  8.13894976  7.17966521  9.00747653  6.45944875  8.59828007  7.16960240
    42  9.76728576  8.80896711 10.64187649  8.06826932 10.24950201  8.66621514
    43  8.52236380  7.58168661  9.34066131  6.97689119  8.81841981  7.97670983
    44  8.78793294  7.84676782  9.60673883  7.23922064  9.08447548  8.22770255
    45  7.89936129  6.94536771  8.74431758  6.28613136  8.27397264  7.17732777
    46  8.46975030  7.52745640  9.35840581  6.73322186  9.05736941  7.11995733
    47  9.61997951  8.66282289 10.47316352  7.97739711 10.01611910  8.75827184
    48  9.40257193  8.45881699 10.22526403  7.83995344  9.70764896  8.79212472
    49  8.66742517  7.70927514  9.54267888  6.96820861  9.15617367  7.59054778
    50  7.65154093  6.69445470  8.52950518  5.94647622  8.15832015  6.57418963
    51  8.69151931  7.74035550  9.52931147  7.09324728  9.04133487  7.99425581
    52  8.22516921  7.26822305  9.10336544  6.51848823  8.73102413  7.12042527
    53  9.23674140  8.27874986 10.09336392  7.58629046  9.64600292  8.35467560
    54  9.58623596  8.62696918 10.45163202  7.91175726 10.02788945  8.60250051
    55  8.84250274  7.89564730  9.72964421  7.11021825  9.41062683  7.53424077
    56 10.03755322  9.09381467 10.85965666  8.47316441 10.33942912  9.41062683
    57  8.02963643  7.07044330  8.89425947  6.36132936  8.47316441  7.11021825
    58 10.50684650  9.55403215 11.34725714  8.89425947 10.85965666  9.72964421
    59  8.70330819  7.74702041  9.55403215  7.07044330  9.09381467  7.89564730
    60  9.65885002  8.70330819 10.50684650  8.02963643 10.03755322  8.84250274
                 7           8           9          10          11          12
    2                                                                         
    3                                                                         
    4                                                                         
    5                                                                         
    6                                                                         
    7                                                                         
    8   0.52138084                                                            
    9   1.51262335  1.42650400                                                
    10  1.37586652  0.85451845  1.66165919                                    
    11  2.03063282  1.84845292  0.57391975  1.84134664                        
    12  1.04530109  1.02880058  0.47235038  1.46752690  1.02565605            
    13  1.55187795  1.14248790  2.38824213  0.83259211  2.64669235  2.09026878
    14  0.53006488  0.40524081  1.80808765  1.07598647  2.25004581  1.38247585
    15  2.01245397  2.14696750  0.96377238  2.57945321  1.22945485  1.14223545
    16  1.86070413  1.40172541  1.36482304  0.81734261  1.28458219  1.42342961
    17  1.79589406  1.29033251  2.19201634  0.54103956  2.32170259  2.00811828
    18  1.92411706  1.40519398  2.12473443  0.56821976  2.19116544  1.99729967
    19  0.52991056  1.02684243  1.55567351  1.86881241  2.12319649  1.10025828
    20  1.45292667  1.19894991  0.49721460  1.21729630  0.66617320  0.62715332
    21  1.36629890  1.15852636  2.57248506  1.29835598  2.93887731  2.18728391
    22  0.53297510  0.34448262  1.10059978  1.00762497  1.56064737  0.68587068
    23  1.26085184  0.90801440  2.25548882  0.87460185  2.57638466  1.91142714
    24  1.45150219  1.16305555  0.59995958  1.12540077  0.73508525  0.69336196
    25  1.44579795  0.92444584  1.69943639  0.06993422  1.85922227  1.51985190
    26  2.03020530  1.51246238  1.94598191  0.67257464  1.92628260  1.90111549
    27  1.50252776  1.03273600  2.16055536  0.55085669  2.38450756  1.89901919
    28  2.26147648  2.63076438  1.99654838  3.31897008  2.41172795  1.90418415
    29  1.30471550  0.78797571  1.75173040  0.16651334  1.96877269  1.51783993
    30  1.59829011  1.88268906  1.19223139  2.51147540  1.66612670  1.07587239
    31  8.88712110  8.64160537  7.40294809  8.28326323  6.85819152  7.87342634
    32  8.81655866  8.44892065  7.49489903  7.87458251  6.92134337  7.92598288
    33  9.31702606  9.10797957  7.81324745  8.80986640  7.28868875  8.28559578
    34  9.10878705  8.72860386  7.81306086  8.13034251  7.24063121  8.23718229
    35  8.15746283  7.77086904  6.88386695  7.16525682  6.31345007  7.30074216
    36  8.61372573  8.24416304  7.29743548  7.66731235  6.72410073  7.72685761
    37  8.01092724  7.68906604  6.61159665  7.20181806  6.04021694  7.06295109
    38  9.52063893  9.14927276  8.20297194  8.56523720  7.62945496  8.63349234
    39  8.94014497  8.61652479  7.53920890  8.12045628  6.96826232  7.99145801
    40  9.94637307  9.57511246  8.62638603  8.98969820  8.05275596  9.05782451
    41  8.00585137  7.68940834  6.59854573  7.21192184  6.02811584  7.05193899
    42  9.60214790  9.30634764  8.16239007  8.85599146  7.59864716  8.62419581
    43  8.52798406  8.13744353  7.26130201  7.52285924  6.69129523  7.67663154
    44  8.79106006  8.40196241  7.51881250  7.78886899  6.94818561  7.93601339
    45  7.84358513  7.48351696  6.51276867  6.92819405  5.93908164  6.94550433
    46  8.21327606  7.97656205  6.72443034  7.63842310  6.18314918  7.19553351
    47  9.53245807  9.19111765  8.15733691  8.66063751  7.58431665  8.60324790
    48  9.39419841  9.01122352  8.10326949  8.40681515  7.53105426  8.52629132
    49  8.50333776  8.20609447  7.06856872  7.75946968  6.50325498  7.52891080
    50  7.47895180  7.18605568  6.04304986  6.75489043  5.47759909  6.50325498
    51  8.65042341  8.28342645  7.32843381  7.71104029  6.75489043  7.75946968
    52  8.04857343  7.75873918  6.60673903  7.32843381  6.04304986  7.06856872
    53  9.14018335  8.80360488  7.75873918  8.28342645  7.18605568  8.20609447
    54  9.45875183  9.14018335  8.04857343  8.65042341  7.47895180  8.50333776
    55  8.60250051  8.35467560  7.12042527  7.99425581  6.57418963  7.59054778
    56 10.02788945  9.64600292  8.73102413  9.04133487  8.15832015  9.15617367
    57  7.91175726  7.58629046  6.51848823  7.09324728  5.94647622  6.96820861
    58 10.45163202 10.09336392  9.10336544  9.52931147  8.52950518  9.54267888
    59  8.62696918  8.27874986  7.26822305  7.74035550  6.69445470  7.70927514
    60  9.58623596  9.23674140  8.22516921  8.69151931  7.65154093  8.66742517
                13          14          15          16          17          18
    2                                                                         
    3                                                                         
    4                                                                         
    5                                                                         
    6                                                                         
    7                                                                         
    8                                                                         
    9                                                                         
    10                                                                        
    11                                                                        
    12                                                                        
    13                                                                        
    14  1.04381777                                                            
    15  3.23247207  2.45752994                                                
    16  1.62690998  1.74773218  2.32437776                                    
    17  0.62590725  1.38434201  3.11880761  1.13730020                        
    18  0.89055423  1.56008463  3.07341075  0.94937994  0.26619842            
    19  2.07878509  1.04294883  1.78335778  2.24427067  2.31559172  2.42881891
    20  1.99679225  1.60383143  1.46098457  0.87306566  1.73055311  1.64272472
    21  0.63764930  0.85111401  3.29467095  2.11378051  1.25128559  1.50952736
    22  1.45782342  0.70751172  1.80378380  1.34936686  1.51014682  1.57581366
    23  0.32684273  0.73837155  3.04601482  1.69146520  0.86245149  1.10935777
    24  1.91503584  1.56813067  1.56370085  0.77457035  1.63344786  1.54144294
    25  0.84028534  1.14146006  2.62479997  0.79252449  0.49425074  0.50198816
    26  1.24193116  1.74734312  2.90899908  0.64411594  0.63527266  0.38005057
    27  0.29284976  1.04275757  3.03754238  1.33465494  0.39116395  0.63885965
    28  3.77020076  2.79046067  1.22755315  3.30876778  3.84556369  3.87409963
    29  0.68386681  0.95621410  2.64690552  0.98335975  0.51676342  0.62026259
    30  3.02322401  2.10622179  0.68862761  2.47996569  3.04505442  3.05906339
    31  9.08126571  9.04534558  7.39183836  7.46636374  8.51672602  8.26562775
    32  8.56833103  8.82578730  7.80319399  7.09265435  7.94988803  7.68382721
    33  9.62272461  9.51319826  7.70741863  7.99761434  9.07798628  8.83370379
    34  8.80497651  9.09994880  8.15041888  7.35928288  8.18309522  7.91691403
    35  7.83807552  8.13979548  7.25964549  6.39714757  7.21623379  6.95004934
    36  8.36003598  8.62035724  7.61529004  6.88627091  7.74146485  7.47539365
    37  7.95112489  8.08104543  6.81426355  6.39363787  7.35154948  7.08952739
    38  9.24938485  9.52426486  8.50834298  7.78789074  8.62888563  8.36269452
    39  8.86229014  9.00769846  7.72643305  7.31464146  8.25861072  7.99542715
    40  9.67145449  9.94996204  8.92445758  8.21320717  9.05044138  8.78424298
    41  7.96606739  8.08269955  6.78696933  6.40198769  7.36893626  7.10760036
    42  9.61857904  9.70348656  8.26597878  8.04287638  9.02493739  8.76444563
    43  8.18660050  8.50419321  7.63969146  6.75974388  7.56346510  7.29739896
    44  8.45271346  8.76926436  7.88753090  7.02513603  7.82952158  7.56346510
    45  7.63896594  7.86385491  6.82281870  6.13818915  7.02513603  6.75974388
    46  8.44318926  8.38094898  6.70362579  6.82281870  7.88753090  7.63969146
    47  9.38113325  9.57703403  8.38094898  7.86385491  8.76926436  8.50419321
    48  9.07547214  9.38113325  8.44318926  7.63896594  8.45271346  8.18660050
    49  8.52629132  8.60324790  7.19553351  6.94550433  7.93601339  7.67663154
    50  7.53105426  7.58431665  6.18314918  5.93908164  6.94818561  6.69129523
    51  8.40681515  8.66063751  7.63842310  6.92819405  7.78886899  7.52285924
    52  8.10326949  8.15733691  6.72443034  6.51276867  7.51881250  7.26130201
    53  9.01122352  9.19111765  7.97656205  7.48351696  8.40196241  8.13744353
    54  9.39419841  9.53245807  8.21327606  7.84358513  8.79106006  8.52798406
    55  8.79212472  8.75827184  7.11995733  7.17732777  8.22770255  7.97670983
    56  9.70764896 10.01611910  9.05736941  8.27397264  9.08447548  8.81841981
    57  7.83995344  7.97739711  6.73322186  6.28613136  7.23922064  6.97689119
    58 10.22526403 10.47316352  9.35840581  8.74431758  9.60673883  9.34066131
    59  8.45881699  8.66282289  7.52745640  6.94536771  7.84676782  7.58168661
    60  9.40257193  9.61997951  8.46975030  7.89936129  8.78793294  8.52236380
                19          20          21          22          23          24
    2                                                                         
    3                                                                         
    4                                                                         
    5                                                                         
    6                                                                         
    7                                                                         
    8                                                                         
    9                                                                         
    10                                                                        
    11                                                                        
    12                                                                        
    13                                                                        
    14                                                                        
    15                                                                        
    16                                                                        
    17                                                                        
    18                                                                        
    19                                                                        
    20  1.66140252                                                            
    21  1.83997624  2.27276287                                                
    22  0.90682905  0.94216972  1.50193236                                    
    23  1.78093190  1.91238425  0.42587412  1.24487475                        
    24  1.69140520  0.10315436  2.21099800  0.92930497  1.84212881            
    25  1.93832283  1.24594577  1.33273184  1.07424325  0.90725340  1.15164112
    26  2.50089779  1.44967841  1.83617230  1.60503673  1.41927308  1.34656684
    27  2.03158591  1.74546394  0.87311785  1.31118886  0.47209502  1.65893300
    28  1.79343809  2.44851954  3.62209514  2.34581950  3.50612780  2.54031008
    29  1.81435014  1.32914631  1.13184336  0.99339927  0.70822989  1.24231536
    30  1.23785810  1.62453983  2.95655829  1.57069268  2.78382503  1.71418331
    31  8.94727031  7.45564773  9.57371459  8.39642231  9.15540400  7.48057219
    32  9.02249256  7.37829035  9.15233172  8.28651343  8.72801272  7.36807230
    33  9.33533285  7.91146353 10.08700900  8.84441266  9.67504747  7.94526236
    34  9.33017698  7.67877055  9.39824460  8.57714147  8.97556388  7.66459436
    35  8.38975866  6.73404199  8.43169529  7.62515819  8.00919076  6.71703847
    36  8.82267349  7.17682120  8.94447892  8.08337026  8.52023749  7.16585763
    37  8.16274026  6.55826886  8.49858895  7.49099802  8.07301145  6.56197538
    38  9.72962534  8.08407378  9.83842054  8.99012073  9.41485936  8.07301145
    39  9.09107144  7.48752790  9.41590789  8.41994071  8.99012073  7.49099802
    40 10.15429645  8.50942204 10.26177305  9.41590789  9.83842054  8.49858895
    41  8.15119360  6.55294286  8.50942204  7.48752790  8.08407378  6.55826886
    42  9.71803053  8.15119360 10.15429645  9.09107144  9.72962534  8.16274026
    43  8.76444563  7.10760036  8.78424298  7.99542715  8.36269452  7.08952739
    44  9.02493739  7.36893626  9.05044138  8.25861072  8.62888563  7.35154948
    45  8.04287638  6.40198769  8.21320717  7.31464146  7.78789074  6.39363787
    46  8.26597878  6.78696933  8.92445758  7.72643305  8.50834298  6.81426355
    47  9.70348656  8.08269955  9.94996204  9.00769846  9.52426486  8.08104543
    48  9.61857904  7.96606739  9.67145449  8.86229014  9.24938485  7.95112489
    49  8.62419581  7.05193899  9.05782451  7.99145801  8.63349234  7.06295109
    50  7.59864716  6.02811584  8.05275596  6.96826232  7.62945496  6.04021694
    51  8.85599146  7.21192184  8.98969820  8.12045628  8.56523720  7.20181806
    52  8.16239007  6.59854573  8.62638603  7.53920890  8.20297194  6.61159665
    53  9.30634764  7.68940834  9.57511246  8.61652479  9.14927276  7.68906604
    54  9.60214790  8.00585137  9.94637307  8.94014497  9.52063893  8.01092724
    55  8.66621514  7.16960240  9.28488850  8.11064688  8.86647195  7.19397639
    56 10.24950201  8.59828007 10.30485551  9.49612828  9.88304241  8.58402563
    57  8.06826932  6.45944875  8.38952585  7.39077389  7.96385158  6.46202912
    58 10.64187649  9.00747653 10.80864989  9.92336822 10.38415615  9.00093893
    59  8.80896711  7.17966521  9.02868480  8.10048951  8.60305743  7.17554122
    60  9.76728576  8.13894976  9.97725607  9.05963471  9.55190091  8.13482204
                25          26          27          28          29          30
    2                                                                         
    3                                                                         
    4                                                                         
    5                                                                         
    6                                                                         
    7                                                                         
    8                                                                         
    9                                                                         
    10                                                                        
    11                                                                        
    12                                                                        
    13                                                                        
    14                                                                        
    15                                                                        
    16                                                                        
    17                                                                        
    18                                                                        
    19                                                                        
    20                                                                        
    21                                                                        
    22                                                                        
    23                                                                        
    24                                                                        
    25                                                                        
    26  0.60597151                                                            
    27  0.55183487  0.96690100                                                
    28  3.37917583  3.80419454  3.65364898                                    
    29  0.20864661  0.79864608  0.41661764  3.33166112                        
    30  2.56928450  2.97693820  2.88035924  0.82992840  2.53642421            
    31  8.25811129  7.88577268  8.78883214  8.39483618  8.44867991  8.07996569
    32  7.83063096  7.32694473  8.29231893  8.97340468  8.03799755  8.44867991
    33  8.78967256  8.45396284  9.32990812  8.63673139  8.97340468  8.39483618
    34  8.08418100  7.56627621  8.53309329  9.32990812  8.29231893  8.78883214
    35  7.11871063  6.59944012  7.56627621  8.45396284  7.32694473  7.88577268
    36  7.62319812  7.11871063  8.08418100  8.78967256  7.83063096  8.25811129
    37  7.16585763  6.71703847  7.66459436  7.94526236  7.36807230  7.48057219
    38  8.52023749  8.00919076  8.97556388  9.67504747  8.72801272  9.15540400
    39  8.08337026  7.62515819  8.57714147  8.84441266  8.28651343  8.39642231
    40  8.94447892  8.43169529  9.39824460 10.08700900  9.15233172  9.57371459
    41  7.17682120  6.73404199  7.67877055  7.91146353  7.37829035  7.45564773
    42  8.82267349  8.38975866  9.33017698  9.33533285  9.02249256  8.94727031
    43  7.47539365  6.95004934  7.91691403  8.83370379  7.68382721  8.26562775
    44  7.74146485  7.21623379  8.18309522  9.07798628  7.94988803  8.51672602
    45  6.88627091  6.39714757  7.35928288  7.99761434  7.09265435  7.46636374
    46  7.61529004  7.25964549  8.15041888  7.70741863  7.80319399  7.39183836
    47  8.62035724  8.13979548  9.09994880  9.51319826  8.82578730  9.04534558
    48  8.36003598  7.83807552  8.80497651  9.62272461  8.56833103  9.08126571
    49  7.72685761  7.30074216  8.23718229  8.28559578  7.92598288  7.87342634
    50  6.72410073  6.31345007  7.24063121  7.28868875  6.92134337  6.85819152
    51  7.66731235  7.16525682  8.13034251  8.80986640  7.87458251  8.28326323
    52  7.29743548  6.88386695  7.81306086  7.81324745  7.49489903  7.40294809
    53  8.24416304  7.77086904  8.72860386  9.10797957  8.44892065  8.64160537
    54  8.61372573  8.15746283  9.10878705  9.31702606  8.81655866  8.88712110
    55  7.96904236  7.59683798  8.49969296  8.13296304  8.15969363  7.80768916
    56  8.99439428  8.47095696  9.43783933 10.23039213  9.20272756  9.69972086
    57  7.05681988  6.60494081  7.55382872  7.87025770  7.25942459  7.39726081
    58  9.48586680  8.98385876  9.94914756 10.50134751  9.69302085 10.01757619
    59  7.69965044  7.21740387  8.17784980  8.67940826  7.90533893  8.18384481
    60  8.64992959  8.16067985  9.12323106  9.61124494  8.85614091  9.13022479
                31          32          33          34          35          36
    2                                                                         
    3                                                                         
    4                                                                         
    5                                                                         
    6                                                                         
    7                                                                         
    8                                                                         
    9                                                                         
    10                                                                        
    11                                                                        
    12                                                                        
    13                                                                        
    14                                                                        
    15                                                                        
    16                                                                        
    17                                                                        
    18                                                                        
    19                                                                        
    20                                                                        
    21                                                                        
    22                                                                        
    23                                                                        
    24                                                                        
    25                                                                        
    26                                                                        
    27                                                                        
    28                                                                        
    29                                                                        
    30                                                                        
    31                                                                        
    32  2.53642421                                                            
    33  0.82992840  3.33166112                                                
    34  2.88035924  0.41661764  3.65364898                                    
    35  2.97693820  0.79864608  3.80419454  0.96690100                        
    36  2.56928450  0.20864661  3.37917583  0.55183487  0.60597151            
    37  1.71418331  1.24231536  2.54031008  1.65893300  1.34656684  1.15164112
    38  2.78382503  0.70822989  3.50612780  0.47209502  1.41927308  0.90725340
    39  1.57069268  0.99339927  2.34581950  1.31118886  1.60503673  1.07424325
    40  2.95655829  1.13184336  3.62209514  0.87311785  1.83617230  1.33273184
    41  1.62453983  1.32914631  2.44851954  1.74546394  1.44967841  1.24594577
    42  1.23785810  1.81435014  1.79343809  2.03158591  2.50089779  1.93832283
    43  3.05906339  0.62026259  3.87409963  0.63885965  0.38005057  0.50198816
    44  3.04505442  0.51676342  3.84556369  0.39116395  0.63527266  0.49425074
    45  2.47996569  0.98335975  3.30876778  1.33465494  0.64411594  0.79252449
    46  0.68862761  2.64690552  1.22755315  3.03754238  2.90899908  2.62479997
    47  2.10622179  0.95621410  2.79046067  1.04275757  1.74734312  1.14146006
    48  3.02322401  0.68386681  3.77020076  0.29284976  1.24193116  0.84028534
    49  1.07587239  1.51783993  1.90418415  1.89901919  1.90111549  1.51985190
    50  1.66612670  1.96877269  2.41172795  2.38450756  1.92628260  1.85922227
    51  2.51147540  0.16651334  3.31897008  0.55085669  0.67257464  0.06993422
    52  1.19223139  1.75173040  1.99654838  2.16055536  1.94598191  1.69943639
    53  1.88268906  0.78797571  2.63076438  1.03273600  1.51246238  0.92444584
    54  1.59829011  1.30471550  2.26147648  1.50252776  2.03020530  1.44579795
    55  0.28914200  2.45364857  1.03627893  2.82035476  2.82669002  2.46386405
    56  3.24689884  1.25773151  3.91944525  0.91950962  1.87687731  1.44208591
    57  1.82212637  1.25175700  2.64572548  1.66688674  1.28219771  1.14238035
    58  2.94387235  1.65693335  3.50358212  1.46912672  2.41333260  1.86528272
    59  2.09276294  0.47313053  2.90227385  0.87816822  0.98230413  0.47701732
    60  2.30604163  0.89074073  2.99251337  0.90192945  1.68928782  1.09085042
                37          38          39          40          41          42
    2                                                                         
    3                                                                         
    4                                                                         
    5                                                                         
    6                                                                         
    7                                                                         
    8                                                                         
    9                                                                         
    10                                                                        
    11                                                                        
    12                                                                        
    13                                                                        
    14                                                                        
    15                                                                        
    16                                                                        
    17                                                                        
    18                                                                        
    19                                                                        
    20                                                                        
    21                                                                        
    22                                                                        
    23                                                                        
    24                                                                        
    25                                                                        
    26                                                                        
    27                                                                        
    28                                                                        
    29                                                                        
    30                                                                        
    31                                                                        
    32                                                                        
    33                                                                        
    34                                                                        
    35                                                                        
    36                                                                        
    37                                                                        
    38  1.84212881                                                            
    39  0.92930497  1.24487475                                                
    40  2.21099800  0.42587412  1.50193236                                    
    41  0.10315436  1.91238425  0.94216972  2.27276287                        
    42  1.69140520  1.78093190  0.90682905  1.83997624  1.66140252            
    43  1.54144294  1.10935777  1.57581366  1.50952736  1.64272472  2.42881891
    44  1.63344786  0.86245149  1.51014682  1.25128559  1.73055311  2.31559172
    45  0.77457035  1.69146520  1.34936686  2.11378051  0.87306566  2.24427067
    46  1.56370085  3.04601482  1.80378380  3.29467095  1.46098457  1.78335778
    47  1.56813067  0.73837155  0.70751172  0.85111401  1.60383143  1.04294883
    48  1.91503584  0.32684273  1.45782342  0.63764930  1.99679225  2.07878509
    49  0.69336196  1.91142714  0.68587068  2.18728391  0.62715332  1.10025828
    50  0.73508525  2.57638466  1.56064737  2.93887731  0.66617320  2.12319649
    51  1.12540077  0.87460185  1.00762497  1.29835598  1.21729630  1.86881241
    52  0.59995958  2.25548882  1.10059978  2.57248506  0.49721460  1.55567351
    53  1.16305555  0.90801440  0.34448262  1.15852636  1.19894991  1.02684243
    54  1.45150219  1.26085184  0.53297510  1.36629890  1.45292667  0.52991056
    55  1.52111602  2.77137286  1.53125186  2.98236240  1.42539445  1.37306336
    56  2.41628158  0.57467911  1.76608949  0.29861668  2.48530318  2.13855173
    57  0.12220347  1.87933785  1.03030225  2.25956321  0.19761165  1.81035271
    58  2.56056237  0.99893386  1.71172558  0.61962488  2.60321066  1.72526630
    59  0.80785802  1.03705814  0.62327989  1.42090959  0.88420050  1.52056590
    60  1.67158415  0.54963295  0.86604646  0.65476091  1.71715197  1.23889937
                43          44          45          46          47          48
    2                                                                         
    3                                                                         
    4                                                                         
    5                                                                         
    6                                                                         
    7                                                                         
    8                                                                         
    9                                                                         
    10                                                                        
    11                                                                        
    12                                                                        
    13                                                                        
    14                                                                        
    15                                                                        
    16                                                                        
    17                                                                        
    18                                                                        
    19                                                                        
    20                                                                        
    21                                                                        
    22                                                                        
    23                                                                        
    24                                                                        
    25                                                                        
    26                                                                        
    27                                                                        
    28                                                                        
    29                                                                        
    30                                                                        
    31                                                                        
    32                                                                        
    33                                                                        
    34                                                                        
    35                                                                        
    36                                                                        
    37                                                                        
    38                                                                        
    39                                                                        
    40                                                                        
    41                                                                        
    42                                                                        
    43                                                                        
    44  0.26619842                                                            
    45  0.94937994  1.13730020                                                
    46  3.07341075  3.11880761  2.32437776                                    
    47  1.56008463  1.38434201  1.74773218  2.45752994                        
    48  0.89055423  0.62590725  1.62690998  3.23247207  1.04381777            
    49  1.99729967  2.00811828  1.42342961  1.14223545  1.38247585  2.09026878
    50  2.19116544  2.32170259  1.28458219  1.22945485  2.25004581  2.64669235
    51  0.56821976  0.54103956  0.81734261  2.57945321  1.07598647  0.83259211
    52  2.12473443  2.19201634  1.36482304  0.96377238  1.80808765  2.38824213
    53  1.40519398  1.29033251  1.40172541  2.14696750  0.40524081  1.14248790
    54  1.92411706  1.79589406  1.86070413  2.01245397  0.53006488  1.55187795
    55  2.94066982  2.95052344  2.29509019  0.43250627  2.13345855  2.98741775
    56  1.52104851  1.25495472  2.23455849  3.56711045  1.14086690  0.63501767
    57  1.50194956  1.61249806  0.68440099  1.64082449  1.64808887  1.93204623
    58  2.10772180  1.85629639  2.60988109  3.39293290  1.00701855  1.25471450
    59  0.97410124  0.95723654  0.82792276  2.17473537  0.92250873  1.11522064
    60  1.46499234  1.26632957  1.76410328  2.64336036  0.20216464  0.86587215
                49          50          51          52          53          54
    2                                                                         
    3                                                                         
    4                                                                         
    5                                                                         
    6                                                                         
    7                                                                         
    8                                                                         
    9                                                                         
    10                                                                        
    11                                                                        
    12                                                                        
    13                                                                        
    14                                                                        
    15                                                                        
    16                                                                        
    17                                                                        
    18                                                                        
    19                                                                        
    20                                                                        
    21                                                                        
    22                                                                        
    23                                                                        
    24                                                                        
    25                                                                        
    26                                                                        
    27                                                                        
    28                                                                        
    29                                                                        
    30                                                                        
    31                                                                        
    32                                                                        
    33                                                                        
    34                                                                        
    35                                                                        
    36                                                                        
    37                                                                        
    38                                                                        
    39                                                                        
    40                                                                        
    41                                                                        
    42                                                                        
    43                                                                        
    44                                                                        
    45                                                                        
    46                                                                        
    47                                                                        
    48                                                                        
    49                                                                        
    50  1.02565605                                                            
    51  1.46752690  1.84134664                                                
    52  0.47235038  0.57391975  1.66165919                                    
    53  1.02880058  1.84845292  0.85451845  1.42650400                        
    54  1.04530109  2.03063282  1.37586652  1.51262335  0.52138084            
    55  0.94434574  1.39657397  2.41066210  0.96108973  1.86336403  1.65484178
    56  2.44762676  3.15006985  1.42055684  2.81440446  1.42166231  1.66146702
    57  0.81366449  0.71816955  1.12324975  0.68047469  1.24465767  1.55745538
    58  2.37281131  3.25526238  1.81896129  2.81120895  1.40684998  1.38047914
    59  1.05180682  1.54293609  0.41894722  1.28239002  0.57964866  1.07119273
    60  1.55036730  2.37460953  1.03088610  1.95956811  0.53356582  0.73161101
                55          56          57          58          59
    2                                                             
    3                                                             
    4                                                             
    5                                                             
    6                                                             
    7                                                             
    8                                                             
    9                                                             
    10                                                            
    11                                                            
    12                                                            
    13                                                            
    14                                                            
    15                                                            
    16                                                            
    17                                                            
    18                                                            
    19                                                            
    20                                                            
    21                                                            
    22                                                            
    23                                                            
    24                                                            
    25                                                            
    26                                                            
    27                                                            
    28                                                            
    29                                                            
    30                                                            
    31                                                            
    32                                                            
    33                                                            
    34                                                            
    35                                                            
    36                                                            
    37                                                            
    38                                                            
    39                                                            
    40                                                            
    41                                                            
    42                                                            
    43                                                            
    44                                                            
    45                                                            
    46                                                            
    47                                                            
    48                                                            
    49                                                            
    50                                                            
    51                                                            
    52                                                            
    53                                                            
    54                                                            
    55                                                            
    56  3.26498835                                                
    57  1.62093076  2.45397658                                    
    58  3.02869760  0.77973192  2.63138966                        
    59  1.99332115  1.61173719  0.84250819  1.83632721            
    60  2.32760672  0.94099913  1.74124525  0.89015088  0.95930453

``` r
plot(hc)
abline(h=8, col="red")
```

![](class07_files/figure-commonmark/unnamed-chunk-18-1.png)

I can get my cluster membership vector by “cutting the tree” with the
`cutree()` function like so:

``` r
grps <- cutree(hc, h=8)
grps
```

     [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
    [39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2

Can you plot `z` colored by our hclust results:

``` r
plot(z, col=grps)
```

![](class07_files/figure-commonmark/unnamed-chunk-20-1.png)

## PCA of UK food data

Read data from the UK food

``` r
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url, row.names=1)
head(x)
```

                   England Wales Scotland N.Ireland
    Cheese             105   103      103        66
    Carcass_meat       245   227      242       267
    Other_meat         685   803      750       586
    Fish               147   160      122        93
    Fats_and_oils      193   235      184       209
    Sugars             156   175      147       139

``` r
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)))
```

![](class07_files/figure-commonmark/unnamed-chunk-22-1.png)

``` r
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
```

![](class07_files/figure-commonmark/unnamed-chunk-23-1.png)

A so-called “Pairs” plot can be useful for small datasets like this

``` r
pairs(x, col=rainbow(10), pch=16)
```

![](class07_files/figure-commonmark/unnamed-chunk-24-1.png)

It is hard to see structure and trends in even this small data-set. How
will we ever do this when we have big datasets with 1,000s or 10s of
thousands of things we are measuring…

### PCA to the rescue

Let’s see how PCA deals with this dataset. So main function in base R to
do PCA is called `prcomp()`

``` r
pca <- prcomp( t(x) )
summary(pca)
```

    Importance of components:
                                PC1      PC2      PC3       PC4
    Standard deviation     324.1502 212.7478 73.87622 2.921e-14
    Proportion of Variance   0.6744   0.2905  0.03503 0.000e+00
    Cumulative Proportion    0.6744   0.9650  1.00000 1.000e+00

Let’s see what is inside this `pca` object taht we created from running
`prcomp()`

``` r
attributes(pca)
```

    $names
    [1] "sdev"     "rotation" "center"   "scale"    "x"       

    $class
    [1] "prcomp"

``` r
pca$x
```

                     PC1         PC2        PC3           PC4
    England   -144.99315   -2.532999 105.768945 -9.152022e-15
    Wales     -240.52915 -224.646925 -56.475555  5.560040e-13
    Scotland   -91.86934  286.081786 -44.415495 -6.638419e-13
    N.Ireland  477.39164  -58.901862  -4.877895  1.329771e-13

``` r
plot(pca$x[,1], pca$x[,2], 
     col=c("black","red","blue","darkgreen"), pch=16,
     xlab="PC1 (67.4%)", ylab="PC2 (29%)")
```

![](class07_files/figure-commonmark/unnamed-chunk-28-1.png)

``` r
## Lets focus on PC1 as it accounts for > 90% of variance 
par(mar=c(10, 3, 0.35, 0))
barplot( pca$rotation[,1], las=2 )
```

![](class07_files/figure-commonmark/unnamed-chunk-29-1.png)
